<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Users</title>
  <link rel="stylesheet" href="/frontend/style.css">
</head>
<body>
  <div class="container">
    <h1>All Users</h1>
    <button id="logout">Logout</button>
    <div id="users"></div>
    <pre id="output"></pre>
  </div>

  <script>
  async function loadUsers() {
    const token = localStorage.getItem('jwt');
    if (!token) {
      document.getElementById('output').textContent = 'No token found. Please login.';
      return;
    }

    const res = await fetch('/pro/userinfo/getall', {
      method: 'GET',
      headers: { 'Authorization': 'Bearer ' + token }
    });

    const data = await res.json();
    document.getElementById('output').textContent = JSON.stringify(data, null, 2);
    if (res.ok && data.users) {
      const container = document.getElementById('users');
      container.innerHTML = '';
      data.users.forEach(u => {
        const el = document.createElement('div');
        el.className = 'user';
        el.textContent = `${u.id} - ${u.name} <${u.email}>`;
        container.appendChild(el);
      });
    }
  }

  document.getElementById('logout').addEventListener('click', ()=>{
    localStorage.removeItem('jwt');
    window.location.href = '/frontend/login.html';
  });

  loadUsers();
  </script>
</body>
</html>